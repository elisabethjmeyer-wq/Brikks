<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Brikks - Gestion de la FAQ">
    <title>FAQ - Administration - Brikks</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/admin-faq.css">
</head>
<body>

<!-- Contenu de la page -->
<div id="faq-page">
    <!-- Page Header -->
    <header class="page-header">
        <div class="page-header-left">
            <h1><span class="header-icon">?</span> Foire aux questions</h1>
            <p class="page-subtitle">G√©rez les questions fr√©quentes pour aider vos √©l√®ves</p>
        </div>
        <div class="page-header-actions">
            <button class="btn btn-categories" id="manageCategoriesBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
                G√©rer les cat√©gories
            </button>
            <button class="btn btn-primary btn-add-question" id="addQuestionBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
                Ajouter une question
            </button>
        </div>
    </header>

    <!-- Loader -->
    <div class="loader-container" id="loader">
        <div class="loader"></div>
        <p>Chargement de la FAQ...</p>
    </div>

    <!-- Contenu principal (masqu√© pendant le chargement) -->
    <div id="faq-content" style="display: none;">

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card stat-questions">
                <div class="stat-icon-wrapper pink">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                </div>
                <div class="stat-value" id="totalQuestions">0</div>
                <div class="stat-label">Questions total</div>
            </div>
            <div class="stat-card stat-texte">
                <div class="stat-icon-wrapper orange">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                </div>
                <div class="stat-value" id="totalTexte">0</div>
                <div class="stat-label">R√©ponses texte</div>
            </div>
            <div class="stat-card stat-video">
                <div class="stat-icon-wrapper purple">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/>
                        <line x1="7" y1="2" x2="7" y2="22"/>
                        <line x1="17" y1="2" x2="17" y2="22"/>
                        <line x1="2" y1="12" x2="22" y2="12"/>
                        <line x1="2" y1="7" x2="7" y2="7"/>
                        <line x1="2" y1="17" x2="7" y2="17"/>
                        <line x1="17" y1="17" x2="22" y2="17"/>
                        <line x1="17" y1="7" x2="22" y2="7"/>
                    </svg>
                </div>
                <div class="stat-value" id="totalVideo">0</div>
                <div class="stat-label">R√©ponses vid√©o</div>
            </div>
        </div>

        <!-- Search and Filter Bar -->
        <div class="search-filter-bar">
            <div class="search-wrapper">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <input type="text" class="search-input" id="searchInput" placeholder="Rechercher une question...">
            </div>
            <span class="questions-count" id="questionsCount">0 questions</span>
        </div>

        <div class="filter-bar">
            <span class="filter-label">Filtrer par :</span>
            <div class="filter-dropdown-wrapper">
                <button class="filter-dropdown-btn" id="filterDropdownBtn">
                    <span class="filter-current">
                        <span class="filter-icon">üìÅ</span>
                        <span class="filter-text">Toutes les cat√©gories</span>
                    </span>
                    <svg class="chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"/>
                    </svg>
                </button>
                <div class="filter-dropdown-menu hidden" id="filterDropdownMenu">
                    <div class="filter-option active" data-value="all">
                        <span class="filter-icon">üìÅ</span>
                        <span class="filter-name">Toutes les cat√©gories</span>
                        <span class="filter-count" id="filterCountAll">0</span>
                    </div>
                    <!-- Dynamically filled -->
                </div>
            </div>
            <input type="hidden" id="filterCategory" value="all">
        </div>

        <!-- Questions List -->
        <div class="questions-list" id="faqList">
            <!-- Dynamically filled -->
        </div>

        <!-- Empty state -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-icon">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#d1d5db" stroke-width="1.5">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
            </div>
            <h3>Aucune question</h3>
            <p>Cliquez sur "Ajouter une question" pour cr√©er votre premi√®re FAQ</p>
        </div>
    </div>
</div>

<!-- MODAL: Nouvelle/√âditer question -->
<div class="modal-overlay hidden" id="questionModal">
    <div class="modal modal-question">
        <div class="modal-header">
            <h2 id="modalTitle"><span class="header-icon">?</span> Ajouter une question</h2>
            <button class="modal-close" id="closeQuestionModal">&times;</button>
        </div>
        <div class="modal-body">
            <input type="hidden" id="questionId">

            <div class="form-group">
                <label>Cat√©gories <span class="required">*</span></label>
                <div class="category-tags-selector" id="categoryTagsSelector">
                    <!-- Dynamically filled with clickable tags -->
                </div>
                <p class="form-hint">Cliquez sur les cat√©gories pour les s√©lectionner</p>
            </div>

            <div class="form-group">
                <label>Question <span class="required">*</span></label>
                <input type="text" class="form-input" id="questionText" placeholder="Ex: Comment sont calcul√©es les notes ?">
            </div>

            <div class="form-group">
                <label>Type de r√©ponse <span class="required">*</span></label>
                <div class="type-selector">
                    <label class="type-option">
                        <input type="radio" name="typeReponse" value="texte" checked>
                        <span class="type-card">
                            <span class="type-icon">
                                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                </svg>
                            </span>
                            <span class="type-name">Texte</span>
                            <span class="type-desc">R√©ponse √©crite</span>
                        </span>
                    </label>
                    <label class="type-option">
                        <input type="radio" name="typeReponse" value="video">
                        <span class="type-card">
                            <span class="type-icon">
                                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polygon points="23 7 16 12 23 17 23 7"/>
                                    <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                                </svg>
                            </span>
                            <span class="type-name">Vid√©o</span>
                            <span class="type-desc">Lien YouTube</span>
                        </span>
                    </label>
                    <label class="type-option">
                        <input type="radio" name="typeReponse" value="mixte">
                        <span class="type-card">
                            <span class="type-icon">
                                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <line x1="3" y1="9" x2="21" y2="9"/>
                                    <line x1="9" y1="21" x2="9" y2="9"/>
                                </svg>
                            </span>
                            <span class="type-name">Mixte</span>
                            <span class="type-desc">Texte + Vid√©o</span>
                        </span>
                    </label>
                </div>
            </div>

            <div class="form-group" id="reponseTexteGroup">
                <label>R√©ponse <span class="required">*</span></label>
                <textarea class="form-textarea" id="questionAnswer" rows="5" placeholder="R√©digez la r√©ponse..."></textarea>
            </div>

            <div class="form-group" id="reponseVideoGroup" style="display: none;">
                <label>URL de la vid√©o <span class="required">*</span></label>
                <input type="url" class="form-input" id="questionVideoUrl" placeholder="https://www.youtube.com/watch?v=...">
                <p class="form-hint">Collez l'URL YouTube ou un lien vid√©o direct</p>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelQuestionBtn">Annuler</button>
            <button class="btn btn-primary" id="saveQuestionBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Enregistrer
            </button>
        </div>
    </div>
</div>

<!-- MODAL: G√©rer les cat√©gories -->
<div class="modal-overlay hidden" id="categoriesModal">
    <div class="modal modal-categories">
        <div class="modal-header">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                </svg>
                G√©rer les cat√©gories
            </h2>
            <button class="modal-close" id="closeCategoriesModal">&times;</button>
        </div>
        <div class="modal-body">
            <div class="add-category-form">
                <input type="text" class="form-input" id="newCategoryName" placeholder="Nouvelle cat√©gorie...">
                <button class="btn btn-primary btn-add-cat" id="addCategoryBtn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
            </div>

            <div class="categories-list" id="categoriesList">
                <!-- Dynamically filled -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="closeCategoriesBtn">Fermer</button>
        </div>
    </div>
</div>

<!-- MODAL: Confirmer suppression -->
<div class="modal-overlay hidden" id="deleteModal">
    <div class="modal modal-confirm">
        <div class="modal-body">
            <div class="confirm-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                    <line x1="10" y1="11" x2="10" y2="17"/>
                    <line x1="14" y1="11" x2="14" y2="17"/>
                </svg>
            </div>
            <h3 class="confirm-title" id="deleteTitle">Supprimer cette question ?</h3>
            <p class="confirm-text" id="deleteConfirmText">Cette action est irr√©versible.</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelDeleteBtn">Annuler</button>
            <button class="btn btn-danger" id="confirmDeleteBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
                Supprimer
            </button>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="../js/config.js"></script>
<script src="../js/sheets.js"></script>
<script src="../js/auth.js"></script>
<script src="../js/app.js"></script>
<script src="../components/admin-layout.js"></script>
<script src="../js/admin-faq.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        AdminLayout.init('faq', 'FAQ');
        AdminFAQ.init();
    });
</script>

</body>
</html>
