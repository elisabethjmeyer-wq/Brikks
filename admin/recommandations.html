<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Brikks - Gestion des recommandations">
    <title>Recommandations - Administration - Brikks</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/admin-recommandations.css">
</head>
<body>

<!-- Contenu de la page -->
<div id="recommandations-page">
    <!-- Page Header -->
    <header class="admin-header">
        <div>
            <h1>üí° Recommandations</h1>
            <p>Partagez des ressources inspirantes avec vos √©l√®ves</p>
        </div>
        <div class="header-actions">
            <button class="btn btn-primary" id="addRecoBtn">
                <span>‚ûï</span>
                Nouvelle recommandation
            </button>
        </div>
    </header>

    <!-- Loader -->
    <div class="loader-container" id="loader">
        <div class="loader"></div>
        <p>Chargement des recommandations...</p>
    </div>

    <!-- Contenu principal (masqu√© pendant le chargement) -->
    <div id="reco-content" style="display: none;">

        <!-- Featured Reco Control -->
        <div class="featured-control">
            <div class="featured-control-header">
                <h2>‚≠ê Recommandation mise en avant</h2>
            </div>
            <div class="featured-control-body">
                <!-- Toggle affichage -->
                <div class="toggle-row">
                    <div class="toggle-info">
                        <h3>Afficher sur la page d'accueil</h3>
                        <p>La recommandation appara√Ætra sur la page d'accueil des √©l√®ves</p>
                    </div>
                    <div class="toggle-switch active" id="toggleDisplay"></div>
                </div>

                <!-- Current reco -->
                <div class="current-reco-section" id="currentRecoSection">
                    <div class="current-reco-label">
                        Recommandation actuellement affich√©e
                        <span class="auto-badge" id="modeBadge">AUTO</span>
                    </div>
                    <div class="current-reco-content" id="currentRecoContent">
                        <!-- Dynamically filled -->
                    </div>
                </div>

                <!-- No reco state -->
                <div class="no-reco-state" id="noRecoState" style="display: none;">
                    <div class="icon">üí°</div>
                    <h3>Aucune recommandation</h3>
                    <p>Ajoutez une recommandation pour qu'elle s'affiche ici</p>
                </div>
            </div>
        </div>

        <!-- Recos List -->
        <div class="recos-card">
            <div class="recos-header">
                <h2>üìö Toutes les recommandations</h2>
                <span class="recos-count" id="recosCount">0 recommandations</span>
            </div>

            <div class="recos-filters">
                <input type="text" class="search-input" id="searchInput" placeholder="Rechercher une recommandation...">
                <select class="filter-select" id="filterType">
                    <option value="all">Tous les types</option>
                    <option value="podcast">Podcasts</option>
                    <option value="video">Vid√©os</option>
                    <option value="livre">Livres</option>
                    <option value="article">Articles</option>
                    <option value="autre">Autres</option>
                </select>
            </div>

            <div class="recos-list" id="recosList">
                <!-- Dynamically filled -->
            </div>

            <!-- Empty state -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">üì≠</div>
                <h3>Aucune recommandation</h3>
                <p>Cliquez sur "Nouvelle recommandation" pour ajouter votre premi√®re recommandation</p>
            </div>
        </div>
    </div>
</div>

<!-- MODAL: Nouvelle/√âditer recommandation -->
<div class="modal-overlay hidden" id="recoModal">
    <div class="modal">
        <div class="modal-header">
            <h2 id="modalTitle">üí° Nouvelle recommandation</h2>
            <button class="modal-close" id="closeRecoModal">√ó</button>
        </div>
        <div class="modal-body">
            <input type="hidden" id="recoId">

            <div class="form-group">
                <label>Titre <span class="req">*</span></label>
                <input type="text" class="form-input" id="recoTitre" placeholder="Ex: Podcast R√©volutions">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Type <span class="req">*</span></label>
                    <select class="form-input" id="recoType">
                        <option value="">S√©lectionner...</option>
                        <option value="podcast">üéß Podcast</option>
                        <option value="video">üé¨ Vid√©o</option>
                        <option value="livre">üìñ Livre</option>
                        <option value="article">üì∞ Article</option>
                        <option value="autre">üìå Autre</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Date de publication</label>
                    <input type="date" class="form-input" id="recoDate">
                </div>
            </div>

            <div class="form-group">
                <label>Description <span class="req">*</span></label>
                <textarea class="form-textarea" id="recoDescription" rows="3" placeholder="Br√®ve description de la ressource..."></textarea>
            </div>

            <div class="form-group">
                <label>Lien URL <span class="req">*</span></label>
                <input type="url" class="form-input" id="recoUrl" placeholder="https://...">
            </div>

            <div class="form-group">
                <label>Image de couverture (URL)</label>
                <input type="url" class="form-input" id="recoImage" placeholder="https://...image.jpg">
                <div class="image-preview" id="imagePreview">
                    <span>Aper√ßu image</span>
                </div>
            </div>

            <div class="form-group">
                <label>Tags (optionnel)</label>
                <input type="text" class="form-input" id="recoTags" placeholder="Ex: Histoire, R√©volution, France">
                <p class="form-help">S√©parez les tags par des virgules</p>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelRecoBtn">Annuler</button>
            <button class="btn btn-primary" id="saveRecoBtn">‚úì Enregistrer</button>
        </div>
    </div>
</div>

<!-- MODAL: S√©lectionner une recommandation -->
<div class="modal-overlay hidden" id="selectModal">
    <div class="modal">
        <div class="modal-header">
            <h2>üîÑ Choisir la recommandation √† afficher</h2>
            <button class="modal-close" id="closeSelectModal">√ó</button>
        </div>
        <div class="modal-body" style="padding: 0;">
            <div class="select-option">
                <label>
                    <input type="radio" name="recoMode" value="auto" checked>
                    <span><strong>Automatique</strong> - Derni√®re recommandation ajout√©e</span>
                </label>
            </div>
            <div class="select-divider">Ou choisir manuellement :</div>
            <div class="select-list" id="selectList">
                <!-- Dynamically filled -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelSelectBtn">Annuler</button>
            <button class="btn btn-primary" id="applySelectBtn">‚úì Appliquer</button>
        </div>
    </div>
</div>

<!-- MODAL: Confirmer suppression -->
<div class="modal-overlay hidden" id="deleteModal">
    <div class="modal confirm">
        <div class="modal-body">
            <div class="confirm-icon">üóëÔ∏è</div>
            <div class="confirm-title">Supprimer cette recommandation ?</div>
            <div class="confirm-text" id="deleteConfirmText">Cette action est irr√©versible.</div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelDeleteBtn">Annuler</button>
            <button class="btn btn-danger" id="confirmDeleteBtn">üóëÔ∏è Supprimer</button>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="../js/config.js"></script>
<script src="../js/sheets.js"></script>
<script src="../js/auth.js"></script>
<script src="../js/app.js"></script>
<script src="../components/admin-layout.js"></script>
<script src="../js/admin-recommandations.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        AdminLayout.init('recommandations', 'Recommandations');
        AdminRecommandations.init();
    });
</script>

</body>
</html>
